var cy; $(function(){ cy = cytoscape({container: document.getElementById('cy'),style: [{"selector":"core","style":{"selection-box-color":"#AAD8FF","selection-box-border-color":"#8BB0D0","selection-box-opacity":"0.5"}},{"selector":"node","style":{"width":"mapData(btwn, 0, 0.082871, 20, 60)","height":"mapData(btwn, 0, 0.082871, 20, 60)","content":"data(name)","font-size":"12px","text-valign":"center","text-halign":"center","background-color":"#ccc","border-color":"data(nodeEdgeColor)","border-width":4,"border-opacity":"data(ratio)","text-outline-color":"#ccc","text-outline-width":"2px","color":"#000","overlay-padding":"6px","z-index":"10"}},{"selector":"edge:selected","style":{"curve-style":"haystack","haystack-radius":"0.5","opacity":"1.0","line-color":"#FFFFFF","line-style":"solid","width":"mapData(weight, 0, 1, 1, 8)","overlay-padding":"3px"}},{"selector":"node:selected","style":{"border-width":"6px","border-color":"#AAD8FF","border-opacity":"0.5","background-color":"#77828C","text-outline-color":"#77828C"}},{"selector":"edge","style":{"curve-style":"haystack","haystack-radius":"0.5","opacity":"0.4","line-color":"data(edgeColor)","line-style":"data(edgeType)","width":"mapData(weight, 0, 1, 1, 8)","overlay-padding":"3px"}},{"selector":"node.unhighlighted","style":{"opacity":"0.2"}},{"selector":"edge.unhighlighted","style":{"opacity":"0.0"}},{"selector":".highlighted","style":{"z-index":"999999"}},{"selector":"node.highlighted","style":{"border-width":"6px","border-color":"#AAD8FF","border-opacity":"0.5","background-color":"#394855","text-outline-color":"#394855","shadow-blur":"12px","shadow-color":"#000","shadow-opacity":"0.8","shadow-offset-x":"0px","shadow-offset-y":"4px"}},{"selector":"edge.filtered","style":{"opacity":"0"}},{"selector":"node.filtered_nonproneural","style":{"width":"mapData(btwn_nonproneural, 0, 0.273149, 20, 60)","height":"mapData(btwn_nonproneural, 0, 0.273149, 20, 60)","content":"data(name)","font-size":"10px","text-valign":"center","text-halign":"center","background-color":"#daa","border-color":"pink","border-width":0,"border-opacity":0,"text-outline-color":"#daa","text-outline-width":"0px","color":"#000","overlay-padding":"6px","z-index":"10","pie-size":"80%","pie-1-background-color":"#E8747C","pie-1-background-size":"mapData(exprone_nonproneural, 0, 1, 0, 100)","pie-2-background-color":"#BBBBBB","pie-2-background-size":"mapData(exprzero_nonproneural, 0, 1, 0, 100)","pie-3-background-color":"#74E883","pie-3-background-size":"mapData(exprnegone_nonproneural, 0, 1, 0, 100)"}},{"selector":"node.filtered_proneural","style":{"width":"mapData(btwn_nonproneural, 0, 0.273149, 20, 60)","height":"mapData(btwn_nonproneural, 0, 0.273149, 20, 60)","content":"data(name)","font-size":"10px","text-valign":"center","text-halign":"center","background-color":"#aad","border-color":"pink","border-width":0,"border-opacity":0,"text-outline-color":"#aad","text-outline-width":"0px","color":"#000","overlay-padding":"6px","z-index":"10","pie-size":"80%","pie-1-background-color":"#E8747C","pie-1-background-size":"mapData(exprone_proneural, 0, 1, 0, 100)","pie-2-background-color":"#BBBBBB","pie-2-background-size":"mapData(exprzero_proneural, 0, 1, 0, 100)","pie-3-background-color":"#74E883","pie-3-background-size":"mapData(exprnegone_proneural, 0, 1, 0, 100)"}},{"selector":"node.filtered_","style":{"width":"mapData(btwn_, 0, 0.082871, 20, 60)","height":"mapData(btwn_, 0, 0.082871, 20, 60)","content":"data(name)","font-size":"10px","text-valign":"center","text-halign":"center","background-color":"#ccc","border-color":"pink","border-width":0,"border-opacity":0,"text-outline-color":"#ccc","text-outline-width":"0px","color":"#000","overlay-padding":"6px","z-index":"10"}}],elements: [
{"data":{ "id": "GAD1","idInt":0, "name":"GAD1","btwn":1.0,"btwn_nonproneural":3.0,"btwn_proneural":0.0,"query":true,"gene":true,"nodeEdgeColor":"red","ratio":1.0,"exprone_nonproneural":0.013793103448275862,"exprzero_nonproneural":0.15172413793103448,"exprnegone_nonproneural":0.8344827586206897,"exprone_proneural":0.05263157894736842,"exprzero_proneural":0.42105263157894735,"exprnegone_proneural":0.5263157894736842},"position":{},"group":"nodes","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{ "id": "TH","idInt":0, "name":"TH","btwn":0.0,"btwn_nonproneural":0.0,"btwn_proneural":0.0,"query":true,"gene":true,"nodeEdgeColor":"grey","ratio":1.0,"exprone_nonproneural":0.06206896551724138,"exprzero_nonproneural":0.6482758620689655,"exprnegone_nonproneural":0.2896551724137931,"exprone_proneural":0.03508771929824561,"exprzero_proneural":0.47368421052631576,"exprnegone_proneural":0.49122807017543857},"position":{},"group":"nodes","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{ "id": "HDC","idInt":0, "name":"HDC","btwn":0.0,"btwn_nonproneural":0.0,"btwn_proneural":0.0,"query":true,"gene":true,"nodeEdgeColor":"grey","ratio":1.0,"exprone_nonproneural":0.15862068965517243,"exprzero_nonproneural":0.33793103448275863,"exprnegone_nonproneural":0.503448275862069,"exprone_proneural":0.19298245614035087,"exprzero_proneural":0.3157894736842105,"exprnegone_proneural":0.49122807017543857},"position":{},"group":"nodes","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{ "id": "DBH","idInt":0, "name":"DBH","btwn":0.0,"btwn_nonproneural":0.0,"btwn_proneural":0.0,"query":true,"gene":true,"nodeEdgeColor":"red","ratio":1.0,"exprone_nonproneural":0.006896551724137931,"exprzero_nonproneural":0.33793103448275863,"exprnegone_nonproneural":0.6551724137931034,"exprone_proneural":0.0,"exprzero_proneural":0.3333333333333333,"exprnegone_proneural":0.6666666666666666},"position":{},"group":"nodes","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{ "id": "PNMT","idInt":0, "name":"PNMT","btwn":1.0,"btwn_nonproneural":0.0,"btwn_proneural":1.0,"query":true,"gene":true,"nodeEdgeColor":"red","ratio":0.5,"exprone_nonproneural":0.006896551724137931,"exprzero_nonproneural":0.38620689655172413,"exprnegone_nonproneural":0.6068965517241379,"exprone_proneural":0.017543859649122806,"exprzero_proneural":0.42105263157894735,"exprnegone_proneural":0.5614035087719298},"position":{},"group":"nodes","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{ "id": "TPH1","idInt":0, "name":"TPH1","btwn":0.0,"btwn_nonproneural":0.0,"btwn_proneural":0.0,"query":true,"gene":true,"nodeEdgeColor":"red","ratio":0.6666666666666666,"exprone_nonproneural":0.07586206896551724,"exprzero_nonproneural":0.903448275862069,"exprnegone_nonproneural":0.020689655172413793,"exprone_proneural":0.05263157894736842,"exprzero_proneural":0.8947368421052632,"exprnegone_proneural":0.05263157894736842},"position":{},"group":"nodes","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{"source":"GAD1","target":"TH","weight":0.25,"edgeColor": "red","edgeType": "dashed" ,"networkId":1133,"networkGroupId":18,"intn":true,"rIntnId":4,"id":"GAD1TH"},"position":{},"group":"edges","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{"source":"GAD1","target":"DBH","weight":0.25,"edgeColor": "red","edgeType": "dashed" ,"networkId":1133,"networkGroupId":18,"intn":true,"rIntnId":4,"id":"GAD1DBH"},"position":{},"group":"edges","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{"source":"GAD1","target":"PNMT","weight":0.25,"edgeColor": "red","edgeType": "dashed" ,"networkId":1133,"networkGroupId":18,"intn":true,"rIntnId":4,"id":"GAD1PNMT"},"position":{},"group":"edges","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{"source":"GAD1","target":"TPH1","weight":0.25,"edgeColor": "red","edgeType": "dashed" ,"networkId":1133,"networkGroupId":18,"intn":true,"rIntnId":4,"id":"GAD1TPH1"},"position":{},"group":"edges","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{"source":"TH","target":"PNMT","weight":0.25,"edgeColor": "blue","edgeType": "dashed" ,"networkId":1133,"networkGroupId":18,"intn":true,"rIntnId":4,"id":"THPNMT"},"position":{},"group":"edges","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{"source":"DBH","target":"PNMT","weight":0.25,"edgeColor": "red","edgeType": "dashed" ,"networkId":1133,"networkGroupId":18,"intn":true,"rIntnId":4,"id":"DBHPNMT"},"position":{},"group":"edges","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{"source":"DBH","target":"TPH1","weight":0.25,"edgeColor": "red","edgeType": "dashed" ,"networkId":1133,"networkGroupId":18,"intn":true,"rIntnId":4,"id":"DBHTPH1"},"position":{},"group":"edges","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
,{"data":{"source":"PNMT","target":"TPH1","weight":0.25,"edgeColor": "grey","edgeType": "dashed" ,"networkId":1133,"networkGroupId":18,"intn":true,"rIntnId":4,"id":"PNMTTPH1"},"position":{},"group":"edges","removed":false,"selected":false,"selectable":true,"locked":false,"grabbed":false,"grabbable":true,"classes":""}
]});
var params = { name: 'cola', nodeSpacing: 10, edgeLengthVal: 35, animate: true, randomize: false, maxSimulationTime: 1500, splitFlag: false, toggle: true }; var layout = makeLayout(); var running = false; cy.on('layoutstart', function(){ running = true; }).on('layoutstop', function(){ running = false; }); layout.run(); var $config = $('#config'); var $btnParam = $('<div class="param"></div>'); $config.append( $btnParam ); var sliders = [ { label: 'Edge length', param: 'edgeLengthVal', min: 1, max: 200 }, { label: 'Node spacing', param: 'nodeSpacing', min: 1, max: 50 } ]; var buttons = [ { label: '<i class="fa fa-random"></i>', layoutOpts: { randomize: true, flow: null }, param: 'Randomize network' }, { label: '<i>CDN</i>', layoutOpts: {splitparam:true}, param: 'Condition-specific dependency network' }, { label: '<i>DDN</i>', layoutOpts: {splitparam:false}, param: 'Differential dependency network' } ]; sliders.forEach( makeSlider ); buttons.forEach( makeButton ); function makeLayout( opts ){ params.randomize = false; params.edgeLength = function(e){ return params.edgeLengthVal / e.data('weight'); }; for( var i in opts ){ params[i] = opts[i]; } return cy.makeLayout( params ); } function makeSlider( opts ){ var $input = $('<input></input>'); var $param = $('<div class="param"></div>'); $param.append('<span class="label label-default">'+ opts.label +'</span>'); $param.append( $input ); $config.append( $param ); var p = $input.slider({ min: opts.min, max: opts.max, value: params[ opts.param ] }).on('slide', _.throttle( function(){ params[ opts.param ] = p.getValue(); layout.stop(); layout = makeLayout(); layout.run(); }, 16 ) ).data('slider'); } function makeButton( opts ){ var elnodes = cy.$('node[idInt=0]'); var eledges_nonproneural = cy.$('edge[edgeColor="red"],edge[edgeColor="grey"]'); var eledges_proneural = cy.$('edge[edgeColor="blue"],edge[edgeColor="grey"]'); var $button = $('<button class="btn btn-default" title="' + opts.param + '">'+ opts.label +'</button>'); $btnParam.append( $button ); $button.on('click', function(){ layout.stop(); if (opts.layoutOpts.splitparam) { params.splitFlag=true; params.toggle=!params.toggle; } else { if (!opts.layoutOpts.randomize) { params.splitFlag=false; } } if (params.splitFlag) { if (params.toggle) { elnodes.removeClass('filtered_nonproneural').addClass('filtered_proneural');
eledges_nonproneural.removeClass('highlighted').addClass('unhighlighted'); eledges_proneural.removeClass('unhighlighted').addClass('highlighted'); } else { elnodes.removeClass('filtered_proneural').addClass('filtered_nonproneural'); eledges_proneural.removeClass('highlighted').addClass('unhighlighted'); eledges_nonproneural.removeClass('unhighlighted').addClass('highlighted'); } } else { elnodes.removeClass('filtered_nonproneural').addClass('core'); elnodes.removeClass('filtered_proneural').addClass('core'); eledges_proneural.removeClass('unhighlighted').addClass('highlighted'); eledges_nonproneural.removeClass('unhighlighted').addClass('highlighted'); } if( opts.fn ){ opts.fn(); } layout = makeLayout( opts.layoutOpts ); layout.run(); }); } cy.edges().forEach(function(n){ var g1 = n.data('source'); var g2 = n.data('target'); n.qtip({ content: [ { name: 'Gene 1 '+ g1 + ' Gene 2 ' + g2 } ].map(function( link ){ return link.name; }).join(''), position: { my: 'top center', at: 'bottom center' }, style: { classes: 'qtip-bootstrap', tip: { width: 16, height: 4 } } }); }); cy.nodes().forEach(function(n){ var g = n.data('name'); n.qtip({ content: [ { name: 'GeneCard', url: 'http://www.genecards.org/cgi-bin/carddisp.pl?gene=' + g }, { name: 'nonproneural mutation data', url: 'http://www.cbioportal.org' }, { name: 'proneural mutation data', url: 'http://www.cbioportal.org' } ].map(function( link ){ return '<a target="_blank" href="' + link.url + '">' + link.name + '</a>'; }).join(''), position: { my: 'top center', at: 'bottom center' }, style: { classes: 'qtip-bootstrap', tip: { width: 16, height: 8 } } }); }); }); // on dom ready 
$(function() { FastClick.attach( document.body ); });
